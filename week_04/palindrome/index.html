<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>回文怪文</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  <meta name="twitter:site" content="@SkyFantasyLab" />
  <meta name="twitter:title" content="回文怪文" />
  <meta name="twitter:description" content="はじめから読んでも、最後から読んでも同じ音（文）になる回文を作ろう。怪文な回文を作ってTwitterでつぶやこう。" />
  <meta name="twitter:image" content="http://wc52.skyfantasylab.work/week_04/palindrome/images/logo.png" />
  <meta name="twitter:card" content="summary_large_image" />
</head>

<body>

  <div id="app">
  <v-app>
    <v-content>
      <v-container>
        <v-row align="start" justify="center">
          <v-img src="images/logo.png" width="480" max-width="600"></v-img>
        </v-row>
      </v-container>
      <v-container>
        <v-form>
          <v-text-field :rules="[hiragana]" outlined shaped label="回文にしたい文を入力してください" v-model="original" />
        </v-form>
        <p>{{ result }}</p>
        <v-alert type="success" :value="parindrome">回文です。</v-alert>
        <v-alert type="error" :value="!parindrome">回文ではありません。</v-alert>
      </v-container>
      <v-container>
        <div id="tweet-button"></div>
      </v-container>
    </v-content>
    <v-footer absolute>
      <v-container class="font-weight-medium">
        <v-row align="center">
          <v-col cols="3">
            <v-img src="images/SFL-logo-white-512.png" width="128"></v-img>
          </v-col>
          <v-col cols="6">
            <v-row justify="center">Powered by <a href="https://wwww.skyarch.net">SKYARCH NETWORKS</a></v-row>
            <v-row justify="center">2019 <strong><a href="https://www.skyfantasylab.work">&copy;SKYARCH FANTASY LABORATORY</a></strong></v-row>
          </v-col>
          <v-col cols="3">
              <v-img src="images/skyarch.gif" width="128"></v-img>
          </v-col>
        </v-row>
      </v-container>
    </v-footer>
  </v-app>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>
  <script src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

  <script>
    function setTweetMessage(text) {
      var removeEl = document.getElementById("tweet-button")
      if (removeEl.hasChildNodes()) {
        removeEl.removeChild(removeEl.firstChild)
      }
      twttr.widgets.createShareButton(
        "http://wc52.skyfantasylab.work/week_04/palindrome/index.html",
        document.getElementById("tweet-button"),
        {
          size: "large",
          text: text,
          hashtags: "回文怪文"
        }
      );
    }

    var app = new Vue({
      el: '#app',
      vuetify: new Vuetify(),
      data: {
        original: '',
        parindrome: false
      },
      computed: {
        result: function() {
          this.parindrome = false
          let reverseText = this.original.split('').reverse().join('')

          if (reverseText == this.original) {
            this.parindrome = true
          }
          setTweetMessage(this.original)
          return reverseText
        }
      },
      methods: {
        hiragana: function(text) {
          const pattern = /^[\u3040-\u309f]+$/
          return pattern.test(text) || "ひらがなで入力をしてください。"
        }
      }
    });</script>
</body>
</html>